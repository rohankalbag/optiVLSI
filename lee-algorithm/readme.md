# Lee's Algorithm


## How is this useful in VLSI 

-  VLSI circuits are complex integrated circuits that contain millions of transistors on a single chip. The routing process involves connecting the various components of the chip such as transistors, gates, and interconnects using metal wires to form a functional circuit.
- Improper routing can lead to delays, signal distortion, and other issues that can result in reduced performance. A well-designed routing scheme can help minimize the area of the circuit and reduce power consumption. Proper routing helps ensure that the chip can be manufactured correctly and reliably, reducing the risk of defects and failures
- Lee's Algorithm is used in automation of the process of routing. It is used to find the shortest path between a start point and end point (which denotes a wire connecting two nets) in a maze which can have obstacles (which could be other routes or components like transistors, gates). 
- Other constraints can be added to Lee's Algorithm such as restriction on the angle of the turns made by the routes, number of turns .etc, to fixate upon the best solution out of the many possibilities of paths it generates.

## How to setup Python environment

- make virtual environment for python : `python3 -m venv lee`
- activate virtual environment: `source lee/bin/activate`
- set up libraries required for lee's algorithm: `pip install -r requirements.txt`

- we are making use of automan to compare the performance of the following
- 1. numba njit accelerated lee's algorithm (`accelerated_lee_algorithm`)
- 2. regular pythonic lee's algorithm (`lee_algorithm`)
- 3. networkx bfs based lee's algorithm (`lee_algorithm_networkx()`)

## Creation of a benchmark maze
- use the `create_benchmark.py` file to create a `.npz` file consisting of a benchmark maze on which the algorithm can be tested

### Instructions to use `create_benchmark.py`

```bash
python3 create_benchmark.py -n size_of_maze -p prob_of_obstacle -f filename
```
- $p$ here denotes the probability of a particular entry of the maze $M[i][j]$ contains an obstacle, and is independent of $i$ and $j$.
- the maze is stored as a $n \times n$ numpy array in `filename.npz` 


## Usage of `lee_algorithm.py`

```bash
python3 lee_algorithm.py --b (optional) [--c -n size -p prob]/[--f -m maze] -sx startx -sy starty -ex endx -ey endy  
```
- if `--c` flag is passed this script directly creates a benchmark of size n and probability p (like how in `create_benchmark.py`)

- if `--f` flag is passed then we need to specify the benchmark maze we are feeding to it by passing it filename as `-m maze` if our benchmark maze is stored in `maze.npz` 

- `sx`, `sy`, `ex` and `ey` need to passed s $$

- if `--b` flag is used then benchmarking will be done using `time.perf_counter()` and the time taken by each of the methods will be printed on three lines in the order (numba, python, networkx), if this flag is not specified, the script will produce two `.pdf` files each containing the plot of the maze generated by the script/passed to the script (in `manuscript/benchmark.pdf`) and one of the possible efficient paths generated by using the algorithm (in `manuscript/foundpath.pdf`) 


## Some Examples

`python3 lee_algorithm --c -n 10 -p 0.1 -sx 0 -sy 0 -ex 6 -ey 6`

### Outputs Obtained

![benchmark](https://user-images.githubusercontent.com/46604893/227737174-a8127750-b69d-4da4-b74c-a9ec52c281be.png)


![foundpath](https://user-images.githubusercontent.com/46604893/227737180-9f62f769-cd46-4fa7-a3fd-8e1b3888837c.png)


`python3 lee_algorithm --c -n 10 -p 0.1 -sx 0 -sy 0 -ex 6 -ey 6 --b`

### Outputs Obtained
```
3.265499992721743e-05
0.0013506120000101873
0.0030815439999969385
```

## Benchmarking using Automan
- to run the automan scripts which benchmarks for given values of maze size run `python3 automate.py`
- the plot generated by automan can be found in `/manuscripts/figures/Lee`

### Results Obtained on Benchmarking
> Values of maze size chosen were $n \in \{ 2, 4, 10, 20, 30, 50, 100, 150, 200, 300, 500 \}$ 

![speedup](https://user-images.githubusercontent.com/46604893/227737162-bda12e56-3c47-438b-bcb4-abe71cf904e7.png)

![timing](https://user-images.githubusercontent.com/46604893/227737167-80f295ae-f029-494a-8fdc-a55bad04ea83.png)


